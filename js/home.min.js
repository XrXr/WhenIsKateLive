// Author: XrXr
// https://github.com/XrXr/WhenIsKateLive
// License: MIT
(function(){function r(b,a){var f=b.get_sorted_array(),c;f.some(function(b,f){if(a.isAfter(b.end))return!1;c=b;return!0});return c?c:f[0]}function l(){var b=moment(),a=moment(0);m(a);a.year(1970);a.isoWeek(1);a.isoWeekday(b.isoWeekday());a.hours(b.hours());a.minutes(b.minutes());a.seconds(b.seconds());b=a.unix();if(n.is_live(b))return k=!0,p(!0);if(k)return k=!1,n=r(g,a),l();k=!1;return p(!1,s(b,n))}var q=new Date,m=function(){var b=q.getTimezoneOffset();return function(a){a.zone(b);return a}}(),
g=function(){function b(a,f,d){if(!(this instanceof b))return new b(a,f,d);this.start=f;a=a.toLowerCase();a=c.indexOf(a);if(-1===a)throw Error("Invalid weekday name");this.isoWeekday=a+1;this.duration=d}function a(b,c){if(!(this instanceof a))return new a(b,c);this.start=b.clone();this.end=b.clone();this.end.add("hours",c);this.duration=c}function f(a,b){return a.start.unix()-b.start.unix()}var c="monday tuesday wednesday thursday friday saturday sunday".split(" "),d=[b("Monday","8:00  PM",3),b("Tuesday",
"10:00 AM",2),b("Wednesday","10:00 AM",2),b("Thursday","10:00 PM",2),b("Friday","5:30  PM",2),b("Saturday","8:00  PM",3),b("Sunday","11:00 AM",2)];a.prototype.convert_time=function(){m(this.start);m(this.end)};a.prototype.normalize=function(){this.start.year(1970);this.start.isoWeeks(1);this.end.year(1970);this.end.isoWeeks(1)};a.prototype.toString=function(){var a=this.start.format("a"),b=this.end.format("a"),c=0<this.start.minutes()?["h:m","a"]:["h","a"],f=0<this.end.minutes()?["h:m","a"]:["h",
"a"];a===b&&c.pop();return this.start.format(c.join(" "))+" to "+this.end.format(f.join(" "))};a.prototype.is_live=function(a){return a>=this.start.unix()&&a<=this.end.unix()};var e={};moment(0);var h=moment(q).isDST()?"-0700":"-0800";Object.defineProperty(e,"length",{value:d.length});d.forEach(function(b,c){e[c]=new a(moment(b.start+" "+h,"h:m a Z").year(1970).isoWeek(1).isoWeekday(b.isoWeekday),b.duration)});Object.defineProperty(e,"get_sorted_array",{value:function(){var a=null;return function(){if(null!==
a)return a;var b=[],c;for(c in this)this.hasOwnProperty(c)&&b.push(this[c]);a=b.sort(f);return b}}()});return e}();window.streams=g;var s=function(){function b(a,b){var d=a+" "+b;return 1<a?d+"s":d}function a(a){var c=moment.duration(1E3*a);a=c.days();var d=c.hours(),e=c.minutes(),c=c.seconds(),h=[];a&&h.push(b(a,"day"));d&&h.push(b(d,"hour"));e&&h.push(b(e,"minute"));c&&h.push(b(c,"second"));return h.join(", ")}return function(b,c){var d=c.start.unix()-b;if(0<d)return a(d);if(0>d)return a(c.start.clone().add("weeks",
1).unix()-b);throw Error("get_countdown() called with Invalid arguments");}}(),p=function(){function b(a,b){a.className&&0<a.className.match(new RegExp("(?:^|\\s)"+b+"(?!\\S)","g")).length&&(a.className=a.className.replace(new RegExp("(?:^|\\s)"+b+"(?!\\S)","g"),""))}for(var a=document.querySelectorAll("tr"),f=a[0];f.children.length<g.length;)f.appendChild(document.createElement("th"));for(var c=0;c<g.length;c++)f.children[c].textContent=g[c].start.format("dddd");for(a=a[1];a.children.length<g.length;)a.appendChild(document.createElement("td"));
for(c=0;c<g.length;c++)a.children[c].textContent=g[c].toString();document.querySelector("small").textContent="All times are converted to your local time";var d=document.querySelector("h3"),e=document.querySelector("h1").children[0];return function(a,c){a?(""===d.className&&(d.className+=" soft-hide"),b(e,"disguise prefix"),e.textContent="Kate is live right now! Click to watch",e.href="http://www.twitch.tv/lovelymomo"):(b(d,"soft-hide"),""===e.className&&(e.className+=" disguise prefix"),e.textContent=
c,e.href="#")}}(),n=g[0],k=!0;l();setInterval(l,1E3)})();
