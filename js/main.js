!function(){"use strict";function e(e){return document.querySelector(e)}function t(e,t){e.classList.add(t)}function n(e,t){e.classList.remove(t)}function r(e,t,n){this.start=e.clone().zone(x),this.end=this.start.clone(),this.end.add("hours",t),this.duration=t;var r=this.start.clone().startOf("isoWeek").unix();this.start_normalized=this.start.unix()-r,this.end_normalized=this.end.unix()-r,this.dom_elements=[],this.canceled=n}function a(e){return e.minutes()>0?["h:m","a"]:["h","a"]}function i(e){var t=e.toLowerCase(),n=z.indexOf(t);if(n===-1)throw new Error("Invalid weekday name");return n+1}function o(e){function t(e){return new r(moment(e.time+" "+n+" "+i(e.weekday)+" 1 1970",a),e.duration,e.canceled)}var n=k?"-0700":"-0800",a="h:m a Z E WW YYYY";return window.export_internals&&(window.streamer_dst=k,window.visitor_timezone_offset=x,window.make_stream=t,window.Stream=r),e.map(t).sort(function(e,t){return e.start_normalized-t.start_normalized})}function d(t,n){function r(e){for(var t=document.createElement("tr");t.children.length<e;)t.appendChild(document.createElement("td"));return t}var a,i,o=e("tr");for(a=0;a<t.length;a++){var d=t[a][0],u=document.createElement("th");u.textContent=d.start.format("dddd"),d.dom_elements.push(u),o.appendChild(u)}var l=e("tbody");for(a=0;a<n;a++){var c=r(t.length);0!==a&&(c.className="auxiliary-slots"),l.appendChild(c)}for(a=0;a<t.length;a++)for(i=0;i<t[a].length;i++){var m=t[a][i],h=l.children[i].children[a];h.appendChild(s(m)),m.dom_elements.push(h),i>=1&&l.children[0].children[a].appendChild(s(m,!0))}}function s(e,n){var r=document.createElement("span"),a=e.toString();return n&&(a=", "+a,t(r,"same-line-slots")),r.textContent=a,e.canceled&&t(r,"canceled"),r}function u(e,t){e=e.filter(function(e){return!e.canceled});for(var n,r=0;r<e.length;r++){var a=e[r];if(!(t>a.end_normalized)){n=a;break}}return n?n:e[0].same_stream_next_week()}function l(e,t){var n=e+" "+t;return e>1?n+"s":n}function c(e){var t=moment.duration(1e3*e),n=t.days(),r=t.hours(),a=t.minutes(),i=t.seconds(),o=[];return n&&o.push(l(n,"day")),r&&o.push(l(r,"hour")),a&&o.push(l(a,"minute")),i&&o.push(l(i,"second")),o.join(", ")}function m(e,t){if(e===t)throw new Error("get_countdown() called with invalid arguments");var n=t-e;return n<0&&(n+=g),c(n)}function h(e,r){return e?(t(C,W),n(M,S),M.textContent="Kate is live right now! Click to watch",void(M.href="http://www.twitch.tv/lovelymomo")):(n(C,W),t(M,S),M.textContent=r,void(M.href="#"))}function f(e,t,n){var r,a,i=!1;for(r=0;r<e.length;r++)for(a=0;a<e[r].dom_elements.length;a++)e[r].start.day()===t?(e[r].dom_elements[a].style.color=E,i=!0):e[r].dom_elements[a].style.color=P;if(!i){var o=n.start.day();for(r=0;r<e.length;r++)if(e[r].start.day()===o)for(a=0;a<e[r].dom_elements.length;a++)e[r].dom_elements[a].style.color=E}}function w(e){var t,n,r=[],a={};for(t=0;t<e.length;t++)if(!(t in a)){a[t]=0;var i=e[t],o=[i],d=i.start.isoWeekday();for(n=0;n<e.length;n++)n in a||e[n].start.isoWeekday()===d&&(o.push(e[n]),a[n]=0);r.push(o)}return r}function v(e){var t=e.unix(),n=t-e.clone().startOf("isoWeek").unix(),r=t-e.clone().startOf("day").unix(),a=e.hour()-Math.floor(r/p);return n+=a*p}function y(){var e=moment(),t=v(e),n=e.day();if(n!==j){if(D.end_normalized>g)return D=Y[0],y();f(Y,n,D)}return j=n,D.is_live(t)?h(!0):t>D.end_normalized?(D=u(Y,t),f(Y,n,D),y()):h(!1,m(t,D.start_normalized))}var _=[{weekday:"Monday",time:"6:00 PM",duration:void 0,canceled:!1},{weekday:"Tuesday",time:"6:00 PM",duration:void 0,canceled:!1},{weekday:"Wednesday",time:"5:00 PM",duration:void 0,canceled:!1},{weekday:"Thursday",time:"9:30 PM",duration:void 0,canceled:!1},{weekday:"Friday",time:"5:00 PM",duration:void 0,canceled:!1},{weekday:"Saturday",time:"3:00 PM",duration:void 0,canceled:!1},{weekday:"Sunday",time:"4:00 PM",duration:void 0,canceled:!1}],p=3600,g=604800,k=moment().tz("america/vancouver").isDST(),x=(new Date).getTimezoneOffset(),z=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];r.prototype.toString=function(){function e(e,t){var n=e.hours(),r=e.minutes();if(0===r){if(12===n)return"Noon";if(0===n)return"Beginning of day"}return e.format(t.join(" "))}var t=this.start,n=this.end,r=t.format("a"),i=n.format("a"),o=a(this.start);if(!this.duration)return e(t,o);var d=a(this.end);return t.isoWeekday()!==n.isoWeekday()?e(t,o)+" for "+this.duration+" hours":(r===i&&o.pop(),e(t,o)+" to "+e(n,d))},r.prototype.is_live=function(e){return!!this.duration&&(e>=this.start_normalized&&e<=this.end_normalized)},r.prototype.same_stream_next_week=function(){var e=new r(this.start,this.duration),t=moment.duration(1,"week").asSeconds();return e.start_normalized+=t,e.end_normalized+=t,e};var C=e("h3"),M=e("h1").children[0],W="hidden",S="disguise",E="#333",P="grey",O=e("#countdown"),T=e("#loading-message"),Y=o(_),L=w(Y),b=Math.max.apply(null,L.map(function(e){return e.length}));d(L,b);var j,D=Y[0];t(T,"hidden"),n(O,"hidden"),y(),setInterval(y,1e3),window.calc_since_week_start=v,window.export_internals&&(window.get_countdown=m,window.streams=Y,window.find_next_stream=u)}();