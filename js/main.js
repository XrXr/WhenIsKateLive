!function(){"use strict";function e(e){return document.querySelector(e)}function t(e,t){e.classList.add(t)}function n(e,t){e.classList.remove(t)}function r(e,t,n){this.start=e.clone().zone(x),this.end=this.start.clone(),this.end.add("hours",t),this.duration=t;var r=this.start.clone().startOf("isoWeek").unix();this.start_normalized=this.start.unix()-r,this.end_normalized=this.end.unix()-r,this.dom_elements=[],this.canceled=n}function o(e){return e.minutes()>0?["h:m","a"]:["h","a"]}function i(e){var t=e.toLowerCase(),n=z.indexOf(t);if(n===-1)throw new Error("Invalid weekday name");return n+1}function a(e){function t(e){return new r(moment(e.time+" "+n+" "+i(e.weekday)+" 1 1970",o),e.duration,e.canceled)}var n=k?"-0700":"-0800",o="h:m a Z E WW YYYY";return window.export_internals&&(window.streamer_dst=k,window.visitor_timezone_offset=x,window.make_stream=t,window.Stream=r),e.map(t).sort(function(e,t){return e.start_normalized-t.start_normalized})}function d(t,n){function r(e){for(var t=document.createElement("tr");t.children.length<e;)t.appendChild(document.createElement("td"));return t}var o,i,a=e("tr");for(o=0;o<t.length;o++){var d=t[o][0],u=document.createElement("th");u.textContent=d.start.format("dddd"),d.dom_elements.push(u),a.appendChild(u)}var l=e("tbody");for(o=0;o<n;o++){var c=r(t.length);0!==o&&(c.className="auxiliary-slots"),l.appendChild(c)}for(o=0;o<t.length;o++)for(i=0;i<t[o].length;i++){var m=t[o][i],h=l.children[i].children[o];h.appendChild(s(m)),m.dom_elements.push(h),i>=1&&l.children[0].children[o].appendChild(s(m,!0))}}function s(e,n){var r=document.createElement("span"),o=e.toString();return n&&(o=", "+o,t(r,"same-line-slots")),r.textContent=o,e.canceled&&t(r,"canceled"),r}function u(e,t){var n=e+" "+t;return e>1?n+"s":n}function l(e){var t=moment.duration(1e3*e),n=t.days(),r=t.hours(),o=t.minutes(),i=t.seconds(),a=[];return n&&a.push(u(n,"day")),r&&a.push(u(r,"hour")),o&&a.push(u(o,"minute")),i&&a.push(u(i,"second")),a.join(", ")}function c(e,t){if(e===t)throw new Error("get_countdown() called with invalid arguments");var n=t-e;return n<0&&(n+=g),l(n)}function m(e,t){e=e.filter(function(e){return!e.canceled});for(var n,r=0;r<e.length;r++){var o=e[r];if(!(t>o.end_normalized)){n=o;break}}return n?n:e[0].same_stream_next_week()}function h(e,r){return e?(t(C,W),n(M,S),M.textContent="Kate is live right now! Click to watch",void(M.href="http://www.twitch.tv/lovelymomo")):(n(C,W),t(M,S),M.textContent=r,void(M.href="#"))}function f(e,t,n){var r,o,i=!1;for(r=0;r<e.length;r++)for(o=0;o<e[r].dom_elements.length;o++)e[r].start.day()===t?(e[r].dom_elements[o].style.color=E,i=!0):e[r].dom_elements[o].style.color=P;if(!i){var a=n.start.day();for(r=0;r<e.length;r++)if(e[r].start.day()===a)for(o=0;o<e[r].dom_elements.length;o++)e[r].dom_elements[o].style.color=E}}function w(e){var t,n,r=[],o={};for(t=0;t<e.length;t++)if(!(t in o)){o[t]=0;var i=e[t],a=[i],d=i.start.isoWeekday();for(n=0;n<e.length;n++)n in o||e[n].start.isoWeekday()===d&&(a.push(e[n]),o[n]=0);r.push(a)}return r}function v(e){var t=e.unix(),n=t-e.clone().startOf("isoWeek").unix(),r=t-e.clone().startOf("day").unix(),o=e.hour()-Math.floor(r/p);return n+=o*p}function y(){var e=moment(),t=v(e),n=m(Y,t);f(Y,e.day(),n),n.is_live(t)?h(!0):h(!1,c(t,n.start_normalized))}var _=[{weekday:"Monday",time:"6:00 PM",duration:void 0,canceled:!1},{weekday:"Tuesday",time:"6:00 PM",duration:void 0,canceled:!1},{weekday:"Wednesday",time:"5:00 PM",duration:void 0,canceled:!1},{weekday:"Thursday",time:"9:30 PM",duration:void 0,canceled:!1},{weekday:"Friday",time:"5:00 PM",duration:void 0,canceled:!1},{weekday:"Saturday",time:"3:00 PM",duration:void 0,canceled:!1},{weekday:"Sunday",time:"4:00 PM",duration:void 0,canceled:!1}],p=3600,g=604800,k=moment().tz("america/vancouver").isDST(),x=(new Date).getTimezoneOffset(),z=["monday","tuesday","wednesday","thursday","friday","saturday","sunday"];r.prototype.toString=function(){function e(e,t){var n=e.hours(),r=e.minutes();if(0===r){if(12===n)return"Noon";if(0===n)return"Beginning of day"}return e.format(t.join(" "))}var t=this.start,n=this.end,r=t.format("a"),i=n.format("a"),a=o(this.start);if(!this.duration)return e(t,a);var d=o(this.end);return t.isoWeekday()!==n.isoWeekday()?e(t,a)+" for "+this.duration+" hours":(r===i&&a.pop(),e(t,a)+" to "+e(n,d))},r.prototype.is_live=function(e){return!!this.duration&&(e>=this.start_normalized&&e<=this.end_normalized)},r.prototype.same_stream_next_week=function(){var e=new r(this.start,this.duration),t=moment.duration(1,"week").asSeconds();return e.start_normalized+=t,e.end_normalized+=t,e};var C=e("h3"),M=e("h1").children[0],W="hidden",S="disguise",E="#333",P="grey",O=e("#countdown"),T=e("#loading-message"),Y=a(_),L=w(Y),b=Math.max.apply(null,L.map(function(e){return e.length}));d(L,b),t(T,"hidden"),n(O,"hidden"),y(),setInterval(y,1e3),window.export_internals&&(window.calc_since_week_start=v,window.find_next_stream=m,window.get_countdown=c,window.group_streams=w,window.tick=y,window.streams=Y)}();